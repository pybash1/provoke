<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Provoke Domain Explorer</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        bg: '#0a0a0c',
                        surface: '#121217',
                        primary: '#6366f1',
                        secondary: '#ec4899',
                        success: '#10b981',
                        danger: '#ef4444',
                        warning: '#f59e0b',
                        'text-dim': '#94a3b8',
                        border: 'rgba(255, 255, 255, 0.08)',
                        glass: 'rgba(255, 255, 255, 0.03)',
                    },
                    fontFamily: {
                        mono: ['"JetBrains Mono"', 'monospace'],
                    },
                },
            },
        }
    </script>
    <style type="text/tailwindcss">
        @layer base {
            body {
                @apply bg-bg text-[#e2e8f0] font-mono leading-relaxed min-h-screen p-8;
            }
            * {
                @apply rounded-none;
            }
        }
        @layer components {
            .explorer-card {
                @apply bg-surface border border-border p-8 mb-8 shadow-2xl;
            }
            .page-item {
                @apply bg-glass border border-border p-5 transition-all duration-200 hover:border-primary flex flex-row justify-between items-center gap-6 min-w-0;
            }
            .sidebar-item {
                @apply block p-3 text-sm text-text-dim border-l-2 border-transparent transition-all duration-200 hover:bg-white/5 hover:text-white;
            }
            .sidebar-item.active {
                @apply border-primary text-primary bg-primary/5;
            }
            .badge {
                @apply px-2 py-0.5 font-bold uppercase text-[0.65rem];
            }
            .input-field {
                @apply bg-bg border border-border px-4 py-2 text-white font-mono outline-none focus:border-primary w-full appearance-none cursor-pointer transition-all;
            }
        }
        /* Custom select arrow */
        .custom-select::after {
            content: '↓';
            @apply absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-text-dim text-xs font-bold;
        }
    </style>
</head>

<body>
    <div class="max-w-[1200px] mx-auto">
        <header class="flex justify-between items-center mb-12">
            <h1 class="text-4xl font-bold tracking-tight text-white">Domain Explorer</h1>
            <a href="/admin" class="text-text-dim hover:text-white font-semibold transition-colors text-sm">Dashboard
                →</a>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            <!-- Sidebar -->
            <aside class="lg:col-span-1 space-y-2 max-h-[70vh] overflow-y-auto pr-2 border-r border-border/50">
                <h3 class="text-xs font-bold text-text-dim uppercase tracking-widest mb-4 px-3">Domains ({{
                    domains|length }})</h3>
                {% for domain in domains %}
                <a href="/domains?domain={{ domain }}"
                    class="sidebar-item {% if selected_domain == domain %}active{% endif %}">
                    {{ domain }}
                </a>
                {% endfor %}
            </aside>

            <!-- Content Area -->
            <main class="lg:col-span-3">
                <div class="explorer-card">
                    <div class="flex flex-col md:flex-row gap-4 justify-between items-start md:items-center mb-8">
                        <div>
                            <h2 class="text-2xl font-bold text-white mb-1">
                                {% if selected_domain %}{{ selected_domain }}{% else %}Select a domain{% endif %}
                            </h2>
                            <p class="text-text-dim text-sm">{{ pages|length }} indexed pages</p>
                        </div>
                        <div class="relative custom-select w-full md:w-64">
                            <select onchange="window.location.href='/domains?domain='+this.value" class="input-field">
                                <option value="">Quick Jump...</option>
                                {% for domain in domains %}
                                <option value="{{ domain }}" {% if selected_domain==domain %}selected{% endif %}>{{
                                    domain }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    {% if selected_domain %}
                    <div class="space-y-3">
                        {% for page in pages %}
                        <div class="page-item">
                            <div class="min-w-0 flex-1">
                                <h4 class="font-bold text-white text-base mb-1 truncate">
                                    <a href="{{ page.url }}" target="_blank"
                                        class="hover:text-primary transition-colors text-sm">{{ page.title or 'Untitled'
                                        }}</a>
                                </h4>
                                <div class="text-[0.65rem] text-text-dim truncate font-mono">{{ page.url }}</div>
                            </div>
                            <div class="flex items-center gap-4 shrink-0">
                                <div class="text-right">
                                    <div
                                        class="text-xs font-bold {% if page.score | float >= 75 %}text-success{% elif page.score | float >= 55 %}text-warning{% else %}text-danger{% endif %}">
                                        {{ page.score }}</div>
                                    <div class="text-[0.6rem] text-text-dim uppercase tracking-tighter">Score</div>
                                </div>
                                <span
                                    class="badge {% if page.tier == 'high' %}bg-success/10 text-success{% elif page.tier == 'medium' %}bg-warning/10 text-warning{% else %}bg-danger/10 text-danger{% endif %}">{{
                                    page.tier }}</span>
                                <form action="/admin/delete_page" method="POST"
                                    onsubmit="return confirm('Delete this page?')">
                                    <input type="hidden" name="url" value="{{ page.url }}">
                                    <button type="submit"
                                        class="text-danger opacity-30 hover:opacity-100 hover:bg-danger/10 p-2 transition-all">Delete</button>
                                </form>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    {% else %}
                    <div class="text-center py-20 bg-black/20 border border-border/50">
                        <div class="text-4xl text-white/10 font-bold mb-4 italic">NO DOMAIN SELECTED</div>
                        <p class="text-text-dim text-sm">Pick a domain from the sidebar to inspect its pages.</p>
                    </div>
                    {% endif %}
                </div>

                <div class="mt-8 text-center">
                    <a href="/admin" class="text-text-dim hover:text-white transition-all text-sm font-semibold">← Back
                        to Admin</a>
                </div>
            </main>
        </div>
    </div>
</body>

</html>